var EditOperations;!function(e){!function(s){class t extends e.BaseOperation{constructor(e,s,t,r,o,i,n,a,l,p,c,m,u,d){super(e,s,t,r,o),this.handleSizeInputFocus=()=>{document.querySelector(this.compressToSizeInputSelector).checked=!0},this.compressResultTemplateSelector=i,this.compressToSizeInputSelector=n,this.compressionTypeInputName=a,this.compressSizeInputSelector=l,this.compressUnitSelectSelector=p,this.compressUnavailableMsgSelector=c,this.compressResultMsgSelector=m,this.sizeBeforeLabelSelector=u,this.sizeAfterLabelSelector=d}init(){super.init(),Utils.BrowserUtils.onDocumentReady((()=>{document.querySelector(this.compressSizeInputSelector).addEventListener("focus",this.handleSizeInputFocus)}))}isCompressionTypeAuto(){return"auto"===document.querySelector(`input[name='${this.compressionTypeInputName}']:checked`).value}gatherOperationParams(){let e;if(this.isCompressionTypeAuto())e=new s.CompressOperationParams(!0);else{let t="KB"===document.querySelector(this.compressUnitSelectSelector).value?1:1024,r=document.querySelector(this.compressSizeInputSelector).value,o=parseInt(r);e=isNaN(o)?new s.CompressOperationParams(!1):new s.CompressOperationParams(!1,o*t)}return e}handleImageOperationCompleteEvent(e,s){super.handleImageOperationCompleteEvent(e,s),s&&("Compress"===e?this.setResultMessage(s):"Convert"===e&&this.handleImageFormatChanged(s))}handleImageFormatChanged(e){let s,t=e.currentImageFormat.toUpperCase();s="JPG"===t||"PNG"===t||"GIF"===t,this.setOperationTriggerEnabled(s),Utils.HtmlUtils.displayElementBlock(this.compressUnavailableMsgSelector,!s)}setResultMessage(e){let s=document.querySelector(this.compressResultTemplateSelector).cloneNode(!0);s.id="compressResult",s.classList.add("d-flex"),s.classList.remove("d-none"),document.querySelector(this.statusContainerSelector).appendChild(s),Utils.HtmlUtils.displayElementFlex(this.statusContainerSelector,!0),document.querySelector(`#compressResult ${this.compressResultMsgSelector}`).innerHTML=Utils.TranslateService.translate("Edit_CompressToolbox_CompressResultInPercents",`<strong>${e.compressionRatio}</strong>`),document.querySelector(`#compressResult ${this.sizeBeforeLabelSelector}`).textContent=e.previousImageLengthFormatted.toString(),document.querySelector(`#compressResult ${this.sizeAfterLabelSelector}`).textContent=e.currentImageLengthFormatted.toString()}}if(s.CompressOperation=t,editPage.hasImage){let s=new e.Compress.CompressOperation("Compress",{usesCropper:!1},"#compressImageBtn","#compressStatus","/api/CompressImage","#compressResultTemplate","#compressToSizeInput","compressionType","#compressSizeInput","#compressUnitSelect","#compressUnavailableMsg",".compress-result-msg",".size-before-label",".size-after-label");s.init(),editPage.registerOperation(s)}}(e.Compress||(e.Compress={}))}(EditOperations||(EditOperations={})),function(e){(e.Compress||(e.Compress={})).CompressOperationParams=class{constructor(e,s){this.auto=e,this.size=s}}}(EditOperations||(EditOperations={}));var CompressFallback={};
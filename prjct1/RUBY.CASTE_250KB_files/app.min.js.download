var EditAppFallback={},Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,EditOperations,EditOperations,EditOperations,EditOperations,Edit,Edit,Edit,Utils,Shared,Shared,Edit,Edit,EditAds;
/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bootstrap=t()}(this,(function(){"use strict";const e="transitionend",t={trigger(e,t){let i=new Event(t,{bubbles:!0,cancelable:!0});return e.dispatchEvent(i),i}},i=(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),o="show",s="collapse",r="collapsing",n=new Map;class a{constructor(e,t){this._element=e,this._parent=t,this._isTransitioning=!1}show(){if(this._isTransitioning||this._isShown())return;let e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((e=>e!==this._element)).map((e=>a.getOrCreateInstance(e,this._parent)));if(!(e.length&&e[0]._isTransitioning||t.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(const t of e)t.hide();requestAnimationFrame((()=>{const e=this._getDimension();this._element.classList.remove(s),this._element.classList.add(r),this._element.style[e]=0,this._isTransitioning=!0,this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(r),this._element.classList.add(s,o),this._element.style[e]="",t.trigger(this._element,"shown.bs.collapse")}),this._element),this._element.style[e]=`${this._element.scrollHeight}px`}))}}hide(){!this._isTransitioning&&this._isShown()&&(t.trigger(this._element,"hide.bs.collapse").defaultPrevented||requestAnimationFrame((()=>{const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,this._element.offsetHeight,this._element.classList.add(r),this._element.classList.remove(s,o),this._isTransitioning=!0,this._element.style[e]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(r),this._element.classList.add(s),t.trigger(this._element,"hidden.bs.collapse")}),this._element)})))}_isShown(e=this._element){return e.classList.contains(o)}_getDimension(){return"height"}_getFirstLevelChildren(e){return i(e,this._parent)}_queueCallback(t,i){((t,i)=>{const o=(e=>{let{transitionDuration:t,transitionDelay:i}=window.getComputedStyle(e);const o=Number.parseFloat(t),s=Number.parseFloat(i);return o||s?(t=t.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(i))):0})(i)+5;let s=!1;const r=({target:o})=>{o===i&&(s=!0,i.removeEventListener(e,r),(e=>{"function"==typeof e&&e()})(t))};i.addEventListener(e,r),setTimeout((()=>{s||i.dispatchEvent(new Event(e))}),o)})(t,i)}static getOrCreateInstance(e,t){let i;return n.has(e)||(i=new a(e,t),n.set(e,i)),i||(i=n.get(e)),i}}return{Collapse:a}})),function(e){e.BrowserUtils=class{static onWindowLoad(e){"complete"===document.readyState?e():window.addEventListener("load",e)}static onDocumentReady(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}}}(Utils||(Utils={})),function(e){e.CookieUtils=class{static getCookie(e){let t=e+"=",i=decodeURIComponent(document.cookie).split(";");for(var o=0;o<i.length;o++){let e=i[o];for(;" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(t))return e.substring(t.length,e.length)}}static setCookie(e,t,i,o="/"){let s=new Date(Date.now()+24*i*60*60*1e3).toUTCString();document.cookie=`${e}=${encodeURIComponent(t)}; expires=${s}; path=${o}; SameSite=none; Secure`}}}(Utils||(Utils={})),function(e){e.EventUtils=class{static triggerEvent(e,t){let i=new Event(t,{bubbles:!0});e.dispatchEvent(i)}static triggerCustomEvent(e,t,i){var o;window.CustomEvent&&"function"==typeof window.CustomEvent?o=new CustomEvent(t,{detail:i}):(o=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,i),e.dispatchEvent(o)}static oneTimeEvent(e,t,i){let o=function(s){e.removeEventListener(t,o),i(s)};e.addEventListener(t,o)}}}(Utils||(Utils={})),function(e){e.ImageResize=class{constructor(t){this.triggerImageChangedEvent=()=>{e.EventUtils.triggerCustomEvent(this.image,"imageChanged")},this.image=document.querySelector(t),this.imageContainer=this.image.parentNode,this.image.addEventListener("contextmenu",(e=>e.preventDefault()))}resizeImageToFitContainer(){this.setImageVisible(!1),this.image.height=this.calcImageHeightToFitContainer(this.image.naturalWidth,this.image.naturalHeight),this.setImageVisible(!0)}setNewImageToFitContainer(t,i,o){let s=this.calcImageHeightToFitContainer(t,i);this.triggerImageChangingEvent(),this.setImageVisible(!1),e.EventUtils.oneTimeEvent(this.image,"load",this.triggerImageChangedEvent),this.image.height=s,this.image.src=o,this.setImageVisible(!0)}triggerImageChangingEvent(){e.EventUtils.triggerCustomEvent(this.image,"imageChanging")}calcImageHeightToFitContainer(e,t){let i,o,s=this.getPixelPropValue(this.imageContainer,"padding-left")+this.getPixelPropValue(this.imageContainer,"padding-right"),r=this.imageContainer.clientWidth-s-1,n=r/e,a=this.getPixelPropValue(this.imageContainer,"padding-bottom")+this.getPixelPropValue(this.imageContainer,"padding-top"),l=this.imageContainer.clientHeight-a-1,d=l/t;return(n<1||d<1)&&(i=n<d?e/r:t/l),o=i?t/i:t,o}getPixelPropValue(e,t){return parseFloat(getComputedStyle(e)[t].replace("px",""))}setImageVisible(e){e?this.image.classList.remove("d-none"):this.image.classList.add("d-none")}}}(Utils||(Utils={})),function(e){e.HtmlUtils=class{static getAriaLabeledBy(e){return e.getAttribute("aria-labelledby").split(" ")}static getIdSelector(e){return"#"+e}static displayElement(e,t,i){const o="d-none";let s=document.querySelector(e);i?(t&&s.classList.add(t),s.classList.remove(o)):(s.classList.add(o),t&&s.classList.remove(t))}static displayElementDefault(t,i){e.HtmlUtils.displayElement(t,void 0,i)}static displayElementBlock(t,i){e.HtmlUtils.displayElement(t,"d-block",i)}static displayElementFlex(t,i){e.HtmlUtils.displayElement(t,"d-flex",i)}static isInputChecked(e){return e.checked}static closestWithClass(e,t,i){if(i&&e.classList.contains(t))return e;let o=e;for(;(o=o.parentNode)&&(!o.classList||!o.classList.contains(t)););return o}static each(e,t){let i=document.querySelectorAll(e);Array.prototype.forEach.call(i,(function(e){t(e)}))}static empty(e){e.textContent=""}}}(Utils||(Utils={})),function(e){e.StringUtils=class{static isNumber(e){return!isNaN(parseInt(e))}}}(Utils||(Utils={})),function(e){e.GAEventLogger=class{static logEvent(e,t){if(!("gtag"in window))return;const i="event";t?gtag(i,e,{info:t}):gtag(i,e)}}}(Utils||(Utils={})),function(e){e.GAPageJsErrorLogger=class{constructor(t){this.logJsError=(t,i,o,s,r)=>{let n;return n=t.toLowerCase().indexOf("script error")>-1?"Script error":`Message: ${t}; URL: ${i}; Line: ${o}; Column: ${s}; Stack: ${r&&r.stack?r.stack:""};`,e.GAEventLogger.logEvent(`${this.page}JsError`,n),!1},this.page=t,window.onerror=this.logJsError}}}(Utils||(Utils={})),function(e){e.TranslateService=class{static translate(t,...i){if(languageTranslate&&languageTranslate.hasOwnProperty(t)){let e=languageTranslate[t];if(0===i.length)return e;let o=e;for(let e=0;e<i.length;e++)o=o.replace(`{${e}}`,i[e]);return o}return e.GAEventLogger.logEvent("TranslateError",`Untranslated string '${t}'`),t}}}(Utils||(Utils={})),function(Utils){class JSLoader{constructor(url,testObjectName){this.checkScriptParsed=(url,testObjectName,retryDelayMs,retryCount,maxRetries,resolveCallback,rejectCallback)=>{let testObject=eval(this.testObjectName);if(testObject)return void resolveCallback();if(retryCount>maxRetries)return void rejectCallback(new Error(`Script parse timeout: '${url}'`));let that=this;setTimeout((function(){that.checkScriptParsed(url,testObjectName,retryDelayMs,retryCount+1,maxRetries,resolveCallback,rejectCallback)}),retryDelayMs)},this.url=url,this.testObjectName=testObjectName}async loadScript(){let testObject=eval(this.testObjectName);if(testObject)return Promise.resolve();let useCdn=cdnConfig.useCdn,url=useCdn?cdnConfig.cdnPrefix+this.url:this.url,loadFailed=!1,loadScriptPromise=this.loadScriptInternal(url,useCdn,this.testObjectName);try{await loadScriptPromise}catch(e){loadFailed=!0}return loadFailed?this.loadScriptInternal(this.url,!1,this.testObjectName):Promise.resolve()}loadScriptInternal(e,t,i){return new Promise(((o,s)=>{let r=document.createElement("script");r.onload=()=>this.checkScriptParsed(e,i,25,1,200,o,s),r.onerror=()=>s(new Error(`Script load error: '${e}'`)),t&&(r.crossOrigin="anonymous"),r.src=e,document.body.appendChild(r)}))}}Utils.JSLoader=JSLoader}(Utils||(Utils={})),function(e){e.OrderedCallbackQueue=class{constructor(e){this.callbackQueue=new Map,this.callbackQueueLength=e,this.currentLength=0}queueCallback(e,t){if(this.callbackQueue.has(e))throw new Error("Such callback order exists");this.callbackQueue.set(e,t),this.currentLength++,this.currentLength===this.callbackQueueLength&&(this.invokeCallbacks(),this.resetQueue())}invokeCallbacks(){let e=[];this.callbackQueue.forEach(((t,i,o)=>{e.push(i)})),e.sort().forEach((e=>{this.callbackQueue.get(e)()}))}resetQueue(){this.callbackQueue.clear(),this.currentLength=0}}}(Utils||(Utils={})),function(e){class t{static yieldToMain(){return new Promise(t.resolveFunc)}}t.resolveFunc=function(e){setTimeout(e,0)},e.TaskManager=t}(Utils||(Utils={})),function(e){e.EditOperationRedirectResult=class{}}(EditOperations||(EditOperations={})),function(e){e.EditOperationErrorResult=class{}}(EditOperations||(EditOperations={})),function(e){e.EditOperationSuccessResult=class{}}(EditOperations||(EditOperations={})),function(e){class t{constructor(e,i,o,s,r){this.handleOperationResult=e=>{let i=e.redirectUrl;if(void 0!==i){let e=document.querySelector(t.UrlCultureHdnSelector);if(e){let t="/"+e.value;0!=i.indexOf(t)&&(i=t+i)}return void window.location.replace(i)}let o=e.errorMessage;if(null!=o)return this.triggerImageOperationCompleteEvent(void 0),void this.setError(o);let s=e;this.setCurrentImageInfo(s)},this.handleOperationFail=e=>{this.triggerImageOperationCompleteEvent(void 0),this.setError(Utils.TranslateService.translate("Error_ServiceUnavailable")),Utils.GAEventLogger.logEvent("EditError",`Response status: ${e.status}`)},this.operationId=e,this.operationMetadata=i,this.operationTriggerSelector=o,this.statusContainerSelector=s,this.apiEndpoint=r}setProgressMediator(e){this.progressMediator=e}setImageResizer(e){this.imgResizer=e}init(){Utils.BrowserUtils.onDocumentReady((()=>{document.querySelector(this.operationTriggerSelector).addEventListener("click",(e=>{this.handleOperationTriggerClick(e.target)}));let e=document.querySelector(t.EditPanelSelector);e&&(e.addEventListener("imageOperationStartEvent",(e=>{let t=e.detail.operationId;this.handleImageOperationStartEvent(t)})),e.addEventListener("imageOperationCompleteEvent",(e=>{let t=e.detail.operationId,i=e.detail.successResult;this.handleImageOperationCompleteEvent(t,i)})))}))}async handleOperationTriggerClick(e){if(!this.permitOperation())return;this.initOperation();let i=this.gatherOperationParams(),o=document.querySelector(t.CultureHdnSelector).value;i.culture=o;let s=this.validateData(i);if(s)return this.hideCurrentStatus(),void this.setError(s);Utils.Ajax.post(this.apiEndpoint,i,void 0,this.handleOperationResult,this.handleOperationFail),this.hideCurrentStatus(),await Utils.TaskManager.yieldToMain(),this.triggerImageOperationStartEvent(),Utils.GAEventLogger.logEvent(this.operationId)}permitOperation(){return!0}initOperation(){}validateData(e){}getImage(){return document.querySelector(t.EditPanelSelector)}setCurrentImageInfo(e){let i=this.getImage(),o=new Image;o.addEventListener("load",(()=>{this.imgResizer.setNewImageToFitContainer(o.naturalWidth,o.naturalHeight,e.currentImagePreviewLink),this.triggerImageOperationCompleteEvent(e)})),o.addEventListener("error",(()=>{i.src=o.src,this.triggerImageOperationCompleteEvent(e)})),o.src=e.currentImagePreviewLink,o.complete&&Utils.EventUtils.triggerEvent(o,"load"),document.querySelector(t.CurrentImageDimensionSelector).textContent=e.currentImageSizeFormatted.toString(),document.querySelector(t.CurrentImageWeightSelector).textContent=e.currentImageLengthFormatted.toString(),document.querySelector(t.CurrentImageFormatSelector).textContent=e.currentImageFormat.toUpperCase(),document.querySelector(t.WidthToHeightHdnSelector).value=e.currentImageWidthToHeightRatio.toString(),document.querySelector(t.WidthHdnSelector).value=e.currentImageWidth.toString(),document.querySelector(t.HeightHdnSelector).value=e.currentImageHeight.toString()}setError(e){let i=document.querySelector(t.ErrorMessageTemplateSelector).cloneNode(!0);i.id="operationError",i.textContent=e,i.classList.remove("d-none"),document.querySelector(this.statusContainerSelector).appendChild(i),Utils.HtmlUtils.displayElementFlex(this.statusContainerSelector,!0)}triggerImageOperationStartEvent(){Utils.EventUtils.triggerCustomEvent(document.querySelector(t.EditPanelSelector),"imageOperationStartEvent",{operationId:this.operationId})}triggerImageOperationCompleteEvent(e){Utils.EventUtils.triggerCustomEvent(document.querySelector(t.EditPanelSelector),"imageOperationCompleteEvent",{operationId:this.operationId,successResult:e})}handleImageOperationStartEvent(e){this.operationId===e&&(this.setControlsEnabled(!0),this.setOperationProgress(!0),this.progressMediator.signalOperationProgressStart())}handleImageOperationCompleteEvent(e,t){this.operationId===e&&(this.setOperationProgress(!1),this.setControlsEnabled(!1),this.progressMediator.signalOperationProgressComplete())}hideCurrentStatus(){Utils.HtmlUtils.displayElementFlex(this.statusContainerSelector,!1),Utils.HtmlUtils.empty(document.querySelector(this.statusContainerSelector))}setOperationProgress(e){Utils.HtmlUtils.displayElementDefault(`${this.operationTriggerSelector} > .operation-progress`,e)}setControlsEnabled(e){this.setOperationTriggerEnabled(!e),this.setControlButtonsEnabled(!e)}setOperationTriggerEnabled(e){this.setHtmlInputsEnabled(document.querySelector(this.operationTriggerSelector),e)}setHtmlInputsEnabled(e,t){const i="disabled";t?e.removeAttribute(i):e.setAttribute(i,"")}setControlButtonsEnabled(e){Utils.HtmlUtils.each(t.ControlButtonsSelector,(t=>{this.setHtmlDisabledClass(t,e),this.setAriaDisabledAttr(t,e)}))}setHtmlDisabledClass(e,t){const i="disabled";t?e.classList.remove(i):e.classList.add(i)}setAriaDisabledAttr(e,t){const i="aria-disabled";t?e.setAttribute(i,"false"):e.setAttribute(i,"true")}}t.MaxSizeHdnSelector="#maxSizeHdn",t.MaxResolutionHdnSelector="#maxResolutionHdn",t.WidthHdnSelector="#widthHdn",t.HeightHdnSelector="#heightHdn",t.WidthToHeightHdnSelector="#wToHRatioHdn",t.CultureHdnSelector="#cultureHdn",t.UrlCultureHdnSelector="#urlCultureHdn",t.EditToolboxSelector="#editToolbox",t.EditPanelSelector="#editPanel",t.OperationProgressSelector="#operationProgress",t.ErrorMessageTemplateSelector="#editErrorMessage",t.ControlButtonsSelector="#uploadNewBtn, #revertBtn, #downloadBtn",t.CurrentImageDimensionSelector="#currentImageDimension",t.CurrentImageWeightSelector="#currentImageWeight",t.CurrentImageFormatSelector="#currentImageFormat",e.BaseOperation=t}(EditOperations||(EditOperations={})),function(e){(e.Progress||(e.Progress={})).OperationStatus=class{constructor(e){this.operationStatusSelector=e}display(e){Utils.HtmlUtils.displayElementFlex(this.operationStatusSelector,e)}setStatus(e){e?document.querySelector(this.operationStatusSelector).textContent=e:Utils.HtmlUtils.empty(document.querySelector(this.operationStatusSelector))}}}(Edit||(Edit={})),function(e){(e.Progress||(e.Progress={})).OperationProgress=class{constructor(e){this.progressIndicatorSelector=e}display(e){Utils.HtmlUtils.displayElementFlex(this.progressIndicatorSelector,e)}}}(Edit||(Edit={})),function(e){(e.Progress||(e.Progress={})).ProgressMediator=class{constructor(){this.operationProgress=new e.Progress.OperationProgress("#operationProgress"),this.operationStatus=new e.Progress.OperationStatus("#operationStatus"),this.initialLoaderActive=!0,Utils.BrowserUtils.onDocumentReady((()=>{Utils.BrowserUtils.onWindowLoad((()=>{this.operationProgress.display(!1),this.initialLoaderActive=!1}))}))}signalOperationProgressStart(){this.statusCapableOperationActive&&this.operationStatus.display(!1),this.operationProgress.display(!0)}signalOperationProgressComplete(){this.operationProgress.display(!1),this.statusCapableOperationActive&&this.operationStatus.display(!0)}signalOperationStatusStart(){this.initialLoaderActive&&this.operationProgress.display(!1),this.operationStatus.setStatus(void 0),this.operationStatus.display(!0),this.statusCapableOperationActive=!0}signalOperationStatusChanged(e){this.operationStatus.setStatus(e)}signalOperationStatusComplete(){this.operationStatus.display(!1),this.statusCapableOperationActive=!1}}}(Edit||(Edit={})),function(e){class t{static post(e,i,o,s,r,n=!1){let a=i instanceof FormData,l=a?i:t.encodeObject(i);t.postWithRetry(e,l,a,o,s,r,n,!0)}static postWithRetry(i,o,s,r,n,a,l,d){let c=new XMLHttpRequest;c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&(200===c.status?(r&&r(),n(c.responseText?JSON.parse(c.responseText):c.responseText)):l&&d?t.postWithRetry(i,o,s,r,n,a,l,!1):(r&&r(),a&&a(c)))},c.open("POST",i,!0),s||c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");try{c.send(o)}catch(t){e.GAEventLogger.logEvent("AjaxError",`Url:${i}, Error:${t.message}`)}}static encodeObject(e){let t=[],i=/%20/g;for(let o in e){let s=e[o],r=void 0===s?"":s,n=`${encodeURIComponent(o).replace(i,"+")}=${encodeURIComponent(r).replace(i,"+")}`;t.push(n)}return t.join("&")}}e.Ajax=t}(Utils||(Utils={})),function(e){class t{constructor(){Utils.BrowserUtils.onDocumentReady((function(){let e=document.querySelector("#cookieConsentAccept");e&&e.addEventListener("click",(function(){let e=document.querySelector("#cookieConsent");e.classList.add("d-none"),e.classList.remove("d-flex"),Utils.CookieUtils.setCookie(t.StandardCookieConsentAcceptedCookie,t.StandardCookieConsentAcceptedCookieValue,365)}))}))}}t.StandardCookieConsentAcceptedCookie="_scca",t.StandardCookieConsentAcceptedCookieValue="1",new t}(Shared||(Shared={})),function(e){e.DropdownMenus=class{constructor(){this.menus=[],this.init=()=>{["lang","menu"].forEach((e=>this.registerMenu(e))),this.initHidingMenusOnExternalClick()},Utils.BrowserUtils.onDocumentReady(this.init)}initHidingMenusOnExternalClick(){document.body.addEventListener("click",(()=>{this.menus.forEach((e=>e.hideMenu()))}))}registerMenu(e){this.menus.push(new t("#"+e,this.menus))}};class t{constructor(e,i){this.displayMenuClickHandler=e=>{this.allMenus.filter((e=>e.menuSelector!==this.menuSelector)).forEach((e=>e.hideMenu())),this.dropdownMenu.classList.toggle(t.ShowDropdownClass),e.preventDefault(),e.stopPropagation()},this.menuSelector=e,this.dropdownMenu=document.querySelector(`${e} > .${t.DropdownMenuClass}`),this.allMenus=i,document.querySelector(`${e} > .${t.DropdownToggleClass}`).addEventListener("click",this.displayMenuClickHandler)}hideMenu(){this.dropdownMenu.classList.remove(t.ShowDropdownClass)}}t.DropdownToggleClass="dropdown-toggle",t.DropdownMenuClass="dropdown-menu",t.ShowDropdownClass="show-dropdown"}(Shared||(Shared={})),function(e){(e.Toolbox||(e.Toolbox={})).EditToolboxExpander=class{constructor(){this.expanderHiddenClass="expander-hidden",this.toolboxExpanderSelector="#toolboxExpander",this.toolboxCollapserSelector="#toolboxCollapser",this.toolboxExpanderItemHiddenClass="toolbox-expander-item-hidden",this.toolboxExpanderItemSelector=`${this.toolboxExpanderSelector} ~ .toolbox-expander-item`,this.expandedCookieName="_texp",this.expandedCookieExpirationDays=365}init(){document.querySelector(this.toolboxExpanderSelector).addEventListener("click",(()=>this.expand())),document.querySelector(this.toolboxCollapserSelector).addEventListener("click",(()=>this.collapse()))}expand(){this.expandInternal(this.toolboxExpanderSelector,this.toolboxExpanderItemSelector,this.toolboxExpanderItemHiddenClass,this.toolboxCollapserSelector),Utils.CookieUtils.setCookie(this.expandedCookieName,"True",this.expandedCookieExpirationDays)}expandInternal(e,t,i,o){document.querySelector(e).classList.add(this.expanderHiddenClass),Utils.HtmlUtils.each(t,(e=>e.classList.remove(i))),document.querySelector(o).classList.remove(this.expanderHiddenClass)}collapse(){this.collapseInternal(this.toolboxExpanderSelector,this.toolboxExpanderItemSelector,this.toolboxExpanderItemHiddenClass,this.toolboxCollapserSelector),Utils.CookieUtils.setCookie(this.expandedCookieName,"False",this.expandedCookieExpirationDays)}collapseInternal(e,t,i,o){document.querySelector(o).classList.add(this.expanderHiddenClass),Utils.HtmlUtils.each(t,(e=>e.classList.add(i))),document.querySelector(e).classList.remove(this.expanderHiddenClass)}}}(Edit||(Edit={})),function(e){(e.Toolbox||(e.Toolbox={})).EditToolboxMoveTopMenuItem=class{moveToolboxItemTop(e,t){t.splice(t.indexOf(e),1),t.unshift(e);let i=t.join(".").concat(".");Utils.Ajax.post("/api/MoveToolboxItemTop",{moveTopToolboxItemId:e,toolboxItemsConfig:i},void 0,this.refreshPage,void 0),Utils.GAEventLogger.logEvent("MoveToolboxItemTop")}refreshPage(){location.reload()}}}(Edit||(Edit={})),function(e){class t{constructor(){let e=this;Utils.BrowserUtils.onDocumentReady((function(){document.querySelector(EditOperations.BaseOperation.EditToolboxSelector).addEventListener("selectedToolboxChanged",e.loadToolboxDynamicAds)}))}loadToolboxDynamicAds(e){let i=e.detail.currentToolboxId;Utils.HtmlUtils.each(`#${i}DynamicMobileBanner, #${i}DynamicBanner`,t.loadBannerAds)}static loadBannerAds(e){const t="data-fuse";if(e.hasAttribute(t))return;let i=e.id,o=-1!==i.indexOf("Mobile")?"22918076938":"22912389605";e.setAttribute(t,o);let s=window.fusetag||(window.fusetag={que:[]});s.que.push((function(){s.registerZone(i)}))}}e.DynamicAds=t}(EditAds||(EditAds={}));class EditPage{constructor(){this.imgSelector="#editPanel",new Utils.GAPageJsErrorLogger("Edit");let e=new Shared.DropdownMenus;this.toolboxMetadatas=[],this.hasImage="true"===document.querySelector("#hasImageHdn").value,this.hasImage?(this.imgResizer=new Utils.ImageResize(this.imgSelector),(new EditPanel).init(this.imgResizer),this.initEditToolbox(e,this.toolboxMetadatas,this.imgSelector),this.progressMediator=new Edit.Progress.ProgressMediator):this.initEditToolbox(e,this.toolboxMetadatas,this.imgSelector),this.binaryOrderedCallbackQueue=new Utils.OrderedCallbackQueue(2),new EditAds.DynamicAds}initEditToolbox(e,t,i){let o=new EditToolbox(e,t,i),s=new Edit.Toolbox.EditToolboxExpander;o.init(),s.init()}registerOperation(e){this.toolboxMetadatas.push({toolboxId:e.operationId,usesCropper:e.operationMetadata.usesCropper}),e.setImageResizer(this.imgResizer),e.setProgressMediator(this.progressMediator)}}class EditToolbox{constructor(e,t,i){this.toolboxChangedTriggered=!1,this.triggerSelectedToolboxChangedEventOnLoad=async e=>{let t=document.querySelector(".toolbox-panel.collapse.show"),i=t?t.getAttribute("data-toolboxid"):void 0;if(i||!e)await this.loadOperationJs(i),this.triggerSelectedToolboxChangedEvent(i);else{let e=this;setTimeout((function(){e.triggerSelectedToolboxChangedEventOnLoad(!1)}),500)}},this.dropdownMenus=e,this.toolboxMetadatas=t,this.editPanelSelector=i}getOrCreateEditToolboxElement(){return this.editToolbox||(this.editToolbox=document.querySelector("#editToolbox")),this.editToolbox}init(){Utils.BrowserUtils.onDocumentReady((()=>{document.querySelector("#editMenu").addEventListener("click",(e=>{this.imageEditingActive||this.handleEditMenuClick(e.target)}));let e=function(e){e.preventDefault()};Utils.HtmlUtils.each(".toolbox-nav-link",(function(t){t.addEventListener("click",e)}));let t=e=>{this.imageEditingActive||this.expandCollapsed(e.currentTarget)};Utils.HtmlUtils.each(".toolbox-item",(function(e){e.addEventListener("click",t)}));let i=e=>{let t=e.currentTarget;this.setParentToolboxVisible(t,"toolbox",!0),this.setExpanderAriaExpandedAttr(t,!1)},o=e=>{let t=e.currentTarget;this.setParentToolboxVisible(t,"toolbox",!1),this.setActiveEditMenuItem(t),this.setExpanderAriaExpandedAttr(t,!0)};Utils.HtmlUtils.each(".toolbox-panel",(function(e){e.addEventListener("hide.bs.collapse",i),e.addEventListener("show.bs.collapse",o)}));let s=function(e){const t="data-numeric-toolboxid";let i=Utils.HtmlUtils.closestWithClass(e.target,"toolbox-item",!1).getAttribute(t),o=document.querySelectorAll(".toolbox-item"),s=[];for(let e=0;e<o.length;e++)s.push(o[e].getAttribute(t));(new Edit.Toolbox.EditToolboxMoveTopMenuItem).moveToolboxItemTop(i,s)};Utils.HtmlUtils.each(".toolbox-menu",(e=>{this.dropdownMenus.registerMenu(e.id),e.querySelector(".move-top-menu").addEventListener("click",s)}));let r=()=>{this.toolboxChangedTriggered||(this.triggerSelectedToolboxChangedEventOnLoad(!0),this.toolboxChangedTriggered=!0)},n=document.querySelector(this.editPanelSelector);n&&(n.addEventListener("imageOperationStartEvent",(()=>{this.imageEditingActive=!0})),n.addEventListener("imageOperationCompleteEvent",(()=>{this.imageEditingActive=!1})),n.complete?r():Utils.EventUtils.oneTimeEvent(n,"load",r)),Utils.BrowserUtils.onWindowLoad(r)}))}handleEditMenuClick(e){let t=Utils.HtmlUtils.closestWithClass(e,"edit-menu-nav",!0);t&&this.expandCollapsed(t)}async expandCollapsed(e){let t=document.querySelector(Utils.HtmlUtils.getIdSelector(e.getAttribute("aria-controls"))),i=t.classList;if(!i.contains("collapse")||!i.contains("show")){let e=this.isMobileDevice(),i=bootstrap.Collapse.getOrCreateInstance(t,this.getOrCreateEditToolboxElement());e&&Utils.EventUtils.oneTimeEvent(t,"shown.bs.collapse",(()=>this.expandedToolboxHandler(t))),i.show(),e||this.expandedToolboxHandler(t)}}isMobileDevice(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)<576}async expandedToolboxHandler(e){await Utils.TaskManager.yieldToMain();let t=e.getAttribute("data-toolboxid");await this.loadOperationJs(t).then(Utils.TaskManager.yieldToMain),this.triggerSelectedToolboxChangedEvent(t)}async loadOperationJs(e){let t=scriptConfig.scripts.find((t=>t.id===e)),i=scriptConfig.basePath+t.path+"?v="+scriptConfig.version,o=new Utils.JSLoader(i,t.fallbackObj);try{await o.loadScript()}catch(t){Utils.GAEventLogger.logEvent(`Load${e}JsError`,t.message)}return Promise.resolve()}triggerSelectedToolboxChangedEvent(e){let t=this.toolboxUsesCropper(this.activeToolboxId),i=this.toolboxUsesCropper(e),o={previousToolboxId:this.activeToolboxId,previousToolboxUsesCropper:t,currentToolboxId:e,currentToolboxUsesCropper:i};Utils.EventUtils.triggerCustomEvent(this.getOrCreateEditToolboxElement(),"selectedToolboxChanged",o),this.activeToolboxId=e}toolboxUsesCropper(e){let t=this.toolboxMetadatas.find((t=>t.toolboxId===e));return t?t.usesCropper:void 0}setActiveEditMenuItem(e){let t,i=Utils.HtmlUtils.getAriaLabeledBy(e);for(let e=0;e<i.length;e++){let o=i[e],s=document.querySelector(Utils.HtmlUtils.getIdSelector(o));if(s.classList.contains("edit-menu-nav")){t=s;break}}document.querySelector(".toolbox-nav-link.active").classList.remove("active"),t.classList.add("active")}setExpanderAriaExpandedAttr(e,t){let i=Utils.HtmlUtils.getAriaLabeledBy(e),o=t.toString();i.forEach((function(e){document.querySelector(Utils.HtmlUtils.getIdSelector(e)).setAttribute("aria-expanded",o)}))}setParentToolboxVisible(e,t,i){let o="d-block",s="d-sm-none",r=Utils.HtmlUtils.closestWithClass(e,t,!1).classList;i?r.add(o,s):r.remove(o,s)}}class EditPanel{constructor(){this.resizeHanlderRegistered=!1}init(e){let t=()=>{this.resizeHanlderRegistered||(window.addEventListener("resize",(function(){e.resizeImageToFitContainer()})),this.resizeHanlderRegistered=!0,e.resizeImageToFitContainer())};Utils.BrowserUtils.onDocumentReady((function(){let i=e.image;i.complete?t():(Utils.EventUtils.oneTimeEvent(i,"load",t),Utils.EventUtils.oneTimeEvent(i,"error",t))}))}}let editPage=new EditPage;